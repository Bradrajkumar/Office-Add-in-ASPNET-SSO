---
topic: sample
products:
- Excel
- PowerPoint
- Word
- Office 365
languages:
- JavaScript
- ASP.NET
extensions:
  contentType: samples
  technologies:
  - Add-ins
  - Microsoft Graph
  services:
  - Excel
  - Office 365
  createdDate: 5/1/2017 2:09:09 PM
---
# <a name="office-add-in-that-that-supports-single-sign-on-to-office-the-add-in-and-microsoft-graph"></a>Надстройка Office, поддерживающая единый вход в Office, надстройку и Microsoft Graph

API `getAccessTokenAsync` в Office.js позволяет пользователям, вошедшим в Office, получить доступ к надстройке, защищенной службой AAD, и к Microsoft Graph без повторного входа. Этот пример основан на ASP.NET и библиотеке идентификации (Майкрософт), или MSAL. 

 > Примечание. Сейчас доступна предварительная версия API `getAccessTokenAsync`.

## <a name="table-of-contents"></a>Содержание
* [История изменений](#change-history)
* [Необходимые компоненты](#prerequisites)
* [Использование проекта](#to-use-the-project)
* [Вопросы и комментарии](#questions-and-comments)
* [Дополнительные ресурсы](#additional-resources)

## <a name="change-history"></a>История изменений

* 10 мая 2017 г.: исходная версия.
* 15 сентября 2017 г: добавлена поддержка 2FA.
* 8 декабря 2017 г.: добавлена расширенная обработка ошибок.
* 7 января 2019 г.: добавлены сведения о методиках обеспечения безопасности для веб-приложений.

## <a name="prerequisites"></a>Необходимые компоненты

* Учетная запись Office 365.
* В предварительной версии для единого входа требуется наличие Office 365 — версии Office, предоставляемой по подписке (другое название — "нажми и работай"). Следует использовать последнюю версию для текущего месяца и сборку из канала для участников программы предварительной оценки. Чтобы получить эту версию, необходимо быть участником программы предварительной оценки Office. Дополнительные сведения см. на странице [Примите участие в программе предварительной оценки Office](https://products.office.com/office-insider?tab=tab-1). Обратите внимание, что когда сборка будет готова к выпуску на канале Semi-Annual Channel, для нее будет отключена поддержка функций предварительной версии, включая единый вход.
* Visual Studio 2017 версии 15.4.0 Preview 1 или выше.

## <a name="deviations-from-best-practices"></a>Отклонения от рекомендаций

Примеры в этом репозитории предназначены исключительно для демонстрации использования интерфейсов API единого входа. Для простоты не соблюдаются некоторые рекомендации, в том числе касающиеся безопасности веб-приложений. *Никакие из этих примеров не следует использовать в качестве отправной точки для создания рабочей надстройки, если только вы не готовы внести существенные изменения.* Чтобы приступить к созданию рабочей надстройки, рекомендуем использовать один из проектов надстроек Office в Visual Studio или создать новый проект с помощью [генератора Yeoman для надстроек Office](https://github.com/OfficeDev/generator-office).

_Одна_ из важных особенностей этих примеров:

* Примеры отправляют жестко закодированный параметр запроса в URL-адресе для REST API Microsoft Graph. Если вы редактируете этот код в рабочей надстройке, а та или иная часть параметра запроса получена из введенных пользователем данных, убедитесь, что он очищен и не может быть использован для атаки путем внедрения заголовка отклика.

## <a name="to-use-the-project"></a>Использование проекта

Этот пример предназначен для сопровождения следующего пошагового руководства: [Создание надстройки Office, в которой используется единый вход, на платформе ASP.NET (предварительная версия)](https://dev.office.com/docs/add-ins/develop/create-sso-office-add-ins-aspnet).

Существует две версии этого примера, хранящиеся в папках Before и Completed.

Чтобы использовать версию из папки Before и вручную добавить важный код для единого входа, следуйте всем инструкциям из статьи по представленной выше ссылке.

Для работы с версией из папки Completed выполните все процедуры из вышеуказанной статьи, кроме разделов "Код на стороне клиента" и "Код на стороне сервера".

## <a name="questions-and-comments"></a>Вопросы и комментарии

Мы будем рады узнать ваше мнение об этом примере. Своими мыслями можете поделиться на вкладке *Issues* (Проблемы) этого репозитория.

Общие вопросы о разработке решений для Microsoft Office 365 следует задавать на сайте [Stack Overflow](http://stackoverflow.com/questions/tagged/office-js+API). Если ваш вопрос касается API JavaScript для Office, добавьте к нему теги [office-js] и [API].

## <a name="additional-resources"></a>Дополнительные ресурсы

* [Документация по надстройкам Office](https://msdn.microsoft.com/ru-ru/library/office/jj220060.aspx)
* [Центр разработки для Office](http://dev.office.com/)
* Другие примеры надстроек Office см. на странице [OfficeDev на сайте Github](https://github.com/officedev).

Этот проект соответствует [правилам поведения Майкрософт, касающимся обращения с открытым кодом](https://opensource.microsoft.com/codeofconduct/). Чтобы получить дополнительные сведения, см. [раздел вопросов и ответов по правилам поведения](https://opensource.microsoft.com/codeofconduct/faq/) или отправляйте новые вопросы и замечания по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).

## <a name="copyright"></a>Авторское право
© Корпорация Майкрософт (Microsoft Corporation), 2017. Все права защищены.

